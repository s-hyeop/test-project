주제: TODO List

|페이지 정리
 01. 인트로 페이지
 02. TODO 목록 페이지
 03. TODO 보기 페이지
 04. TODO 작성 페이지
 05. TODO 수정 페이지
 06. 로그인 이메일 입력 페이지
 07. 로그인 페이지
 08. 회원가입 페이지 -(이메일 인증 대기)> Waiting Modal -(이메일 인증 성공)> Success Modal -> 로그인 페이지로 이동
 09. 비밀번호 초기화, 이메일 입력 페이지 -(이메일 인증 대기)> Waiting Modal -(이메일 인증 성공)> Success Modal -> 비밀번호 초기화 페이지로 이동
 10. 비밀번호 초기화, 비밀번호 초기화 페이지 -> Success Modal -> 로그인 페이지로 이동
 11. 마이 페이지 - 회원 정보 및 투두 통계, 비밀번호 변경, 현재 접속된 계정 불러오기
 12. 이메일 인증 완료[ 회원가입, 이메일 ]
 13. 이메일 인증 실패[ 회원가입, 이메일 ]

|페이지별 요구 사항 정리
 1. TODO 메모지 색상 지원
 2. TODO 통계 [ TODO 전체 달성률, 오늘 완료한 TODO, 미완료 TODO ]
 3. 현재 접속된 계정 불러오기

|JWT 구조
 * 로그인
  - AT(JWT), RT 발급
 * 재발급
  - 1. IF (AT.expiresAt - 임계시간 >= now()) 비정상 재발급
  - 2. IF (RT.expiresAt >= now()) 만료
  - 3. AT 발급, RT 재발급, RT DB 갱신(RT, RT.TTL, RT.expiresAt)
 * 그 외 요청
  - IF AT 만료: 40X
  - IF AT 만료 임박: header "X-Token-Refresh-Now: 1"

|데이터베이스
  users [
    user_no, int, [PK, AI, NN] # 회원 고유 번호
    email, varchar(300), [UK, NN] # 이메일
    password, varchar(100), [NN] # 비밀번호
    user_name, varchar(30), [NN] # 회원이름
    role, varchar(10), [NN] # 권한
    created_at, DATETIME, [NN] # 생성일
    deleted_at, DATETIME, [NN] # 탈퇴일
    last_login_at, DATETIME, [NN] # 마지막 로그인 일
  ]
  todos [
    todo_id, char(36), [PK, NN] # TODO 아이디
    user_no, int, [NN, FK(users.user_no ON DELETE `삭제`)] # 이메일
    title, VARCHAR(300), [NN] # 제목
    content, TEXT, [NN] # 내용
    color, VARCHAR(30), [NN] # 색상
    sequence, INT, [NN] # 순서
    due_at, DATE, [NN] # 마감일
    completed_at, DATETIME # 완료일
    created_at, DATETIME, [NN] # 생성일
    updated_at, DATETIME # 수정일
  ]
  tokens [
    token_no, [PK, AI, NN]
    user_no, int, [NN, FK(users.user_no ON DELETE `삭제`)] # 이메일
    refresh_token, char(36), [NN, UK] # refresh_token
    issued_os, varchar(100), [NN] # 최초 발급 OS
    access_token_expires_at, DATETIME, [NN] # AT 만료일자
    refresh_token_expires_at, DATETIME, [NN] # RT 만료일자
    created_at, DATETIME, [NN] # 토큰 생성일자
  ]

|REST API
 01. todo 목록 불러오기
 02. todo 단일 불러오기
 03. todo 작성
 04. todo 수정
 05. todo 미완료 -> 완료
 06. todo 완료 -> 미완료
 07. todo 순서 변경
 08. todo 삭제
 09. 이메일 있는지 확인
 10. 로그인 처리
 11. 회원가입 요청 (이메일 인증번호 전송)
 12. 회원가입 인증번호 확인(실제 처리)
 13. 비밀번호 초기화 요청 (이메일 인증번호 전송)
 14. 회원 정보 불러오기
 15. todo 정보 불러오기
 16. 로그인된 정보 불러오기
 17. 회원 정보 변경
 18. 비밀번호 변경
 19. 토큰 재발급
 20. 타겟 로그아웃
 21. 현재 로그아웃
 22. 로그인 상태 확인

|참고
 * 시간
  - Java OffsetDateTime
  - DB DATETIME

 * [보안] 이메일 인증 회수 제한
  - redis signup:email-code:난수 = ******
  - redis signup:email-fail-count:난수 = ******
  - 인증 시도 -> count 읽기 -> if count<=5 -> 실패 -> --count

 * [보안] 환경변수 관리 (Git에 업로드 되지 않도록)

 * [보안] 로그인 Rate Limiting
  - 실패 {
    TTL 설정
    없으면 redis 추가
    있으면 ++counter
  }

 * 로그 레벨
  1. TRACE
  2. DEBUG
  3. INFO
  4. WARN
  5. ERROR
  6. FATAL